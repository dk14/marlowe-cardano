#!/usr/bin/env bash
#
ENVIRONMENT=${ENVIRONMENT:-"preview"}

eval "$(ssh dev@dapps.aws.iohkdev.io -p 4022 \
  cat /local/network.env \
  | sed -n "/^${ENVIRONMENT^^}_/s/^${ENVIRONMENT^^}_//p")"

ssh dev@a.dapps.aws.iohkdev.io -p 4022 \
  -L "13720:$CHAINSEEKD_IP:$CHAINSEEKD_COMMAND_PORT" \
  -L "13716:$CHAINSEEKD_IP:$CHAINSEEKD_QUERY_PORT" \
  -L "13715:$CHAINSEEKD_IP:$CHAINSEEKD_PORT" \
  -L "13717:$HISTORY_IP:$HISTORY_PORT" \
  -L "13718:$HISTORY_IP:$HISTORY_QUERY_PORT" \
  -L "13719:$HISTORY_IP:$HISTORY_SYNC_PORT" \
  -L "13721:$DISCOVERY_IP:$DISCOVERY_QUERY_PORT" \
  -L "13722:$DISCOVERY_IP:$DISCOVERY_SYNC_PORT" \
  -L "13723:$TX_IP:$TX_PORT"
